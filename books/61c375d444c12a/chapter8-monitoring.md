---
title: "第9章: 監視と分析"
---

## 9.1 Microsoft 365 の監視ツール概要

### 利用可能な監視ツール
1. **Microsoft 365 管理センター**
   - サービス正常性
   - 使用状況レポート
   - メッセージセンター

2. **セキュリティ & コンプライアンスセンター**
   - セキュリティダッシュボード
   - 脅威の追跡
   - 監査ログ検索

3. **各サービスの管理センター**
   - Teams 分析
   - SharePoint レポート
   - Exchange レポート

4. **Azure AD レポート**
   - サインインログ
   - 監査ログ
   - セキュリティレポート

## 7.2 利用状況の監視

### Microsoft 365 使用状況レポート
1. **アクティブユーザー**
   ```
   管理センター > レポート > 使用状況
   - 日次/月次アクティブユーザー数
   - サービス別利用者数
   - デバイス別アクセス
   ```

2. **サービス別レポート**
   - **Exchange**: メール送受信量、モバイル利用
   - **SharePoint**: サイト訪問数、ファイル操作
   - **OneDrive**: ストレージ使用量、同期状況
   - **Teams**: 会議時間、チャット数、通話数

### カスタムレポートの作成
```powershell
# Graph APIを使用した利用状況データの取得
$uri = "https://graph.microsoft.com/v1.0/reports/getTeamsUserActivityCounts(period='D30')"
$report = Invoke-RestMethod -Uri $uri -Headers $headers -Method Get
```

## 7.3 パフォーマンス監視

### Microsoft 365 ネットワーク接続性テスト
1. **接続性テストツール**
   ```
   管理センター > 正常性 > ネットワーク接続性
   - 場所の追加（学校の所在地）
   - 自動テストの実行
   - 推奨事項の確認
   ```

2. **主要メトリクス**
   - Exchange への遅延
   - SharePoint への遅延
   - Teams の通話品質

### エンドユーザーエクスペリエンス
1. **Teams 通話品質ダッシュボード**
   - 通話品質の傾向
   - 問題のあるユーザー/場所
   - ネットワーク問題の特定

2. **生産性スコア**
   ```
   管理センター > レポート > 生産性スコア
   - コミュニケーション
   - 会議
   - コンテンツコラボレーション
   - チームワーク
   ```

## 7.4 セキュリティ監視

### Microsoft Secure Score
1. **セキュリティ態勢の評価**
   ```
   security.microsoft.com > Secure Score
   - 現在のスコア/最大スコア
   - 改善アクション
   - 業界比較
   ```

2. **推奨アクションの実施**
   - 優先度順の改善提案
   - 実装の影響度
   - 実装難易度

### 脅威の検出と対応
1. **アラートの管理**
   ```
   セキュリティセンター > インシデント
   - 重要度別フィルター
   - 自動調査結果
   - 対応アクション
   ```

2. **高度な検索（Advanced Hunting）**
   ```kusto
   // 過去7日間の外部共有アクティビティ
   CloudAppEvents
   | where Timestamp > ago(7d)
   | where ActionType == "FileSharedExternally"
   | summarize Count=count() by AccountDisplayName
   ```

## 7.5 監査ログの活用

### 監査ログの検索
1. **基本的な検索**
   ```
   コンプライアンスセンター > 監査
   - アクティビティ: ファイルとページのアクティビティ
   - ユーザー: 特定ユーザーまたは全員
   - 日付範囲: 過去90日まで
   ```

2. **高度な検索条件**
   - IPアドレス
   - ワークロード（Exchange、SharePoint等）
   - 結果のフィルタリング

### 重要な監査イベント
1. **管理者アクティビティ**
   - ユーザー作成/削除
   - 権限の変更
   - ポリシーの変更

2. **セキュリティイベント**
   - ログイン失敗
   - 異常なファイルアクセス
   - 大量ダウンロード

## 7.6 アラートとレポートの自動化

### アラートポリシーの設定
1. **カスタムアラート作成**
   ```
   コンプライアンスセンター > アラート > アラートポリシー
   
   例: 大量ファイル削除の検出
   - アクティビティ: ファイルの削除
   - 条件: 100件以上/1時間
   - 通知: IT管理者へメール
   ```

2. **既定のアラートポリシー**
   - 異常なファイルアクティビティ
   - マルウェアの検出
   - 管理者権限の昇格

### Power Automate による自動化
1. **定期レポートの自動生成**
   ```
   フロー例:
   1. 毎週月曜日にトリガー
   2. Graph APIで利用状況データ取得
   3. Excelファイルに出力
   4. メールで管理者に送信
   ```

2. **インシデント対応の自動化**
   - セキュリティアラート受信
   - Teamsチャネルへ通知
   - チケット作成
   - 初期対応手順の実行

## 7.7 コスト管理と最適化

### ライセンス使用状況
1. **未使用ライセンスの特定**
   ```
   管理センター > 課金 > ライセンス
   - 割り当て済み/未割り当て
   - 非アクティブユーザー
   - サービス別使用率
   ```

2. **最適化の提案**
   - ライセンスの再配分
   - 不要なサービスの無効化
   - ライセンスタイプの見直し

### ストレージ使用量
1. **容量監視**
   - SharePoint サイト別使用量
   - OneDrive ユーザー別使用量
   - 増加傾向の分析

2. **クリーンアップ活動**
   - 古いファイルの特定
   - 重複ファイルの検出
   - 大容量ファイルの管理

## 7.8 レポーティング戦略

### 定期レポートの設計
1. **経営層向けレポート（月次）**
   - 利用状況サマリー
   - セキュリティインシデント
   - コスト分析
   - 主要KPI

2. **運用レポート（週次）**
   - サービス可用性
   - パフォーマンス指標
   - ヘルプデスクチケット
   - 実施した変更

### ダッシュボードの構築
1. **Power BI による可視化**
   - リアルタイムダッシュボード
   - トレンド分析
   - 予測分析

2. **主要指標（KPI）**
   - 月間アクティブユーザー率
   - セキュリティスコア
   - インシデント解決時間
   - ユーザー満足度

## 7.9 トラブルシューティングツール

### Microsoft 365 サポート診断ツール
1. **セルフサービス診断**
   ```
   管理センター > サポート > 新しいサービスリクエスト
   - 問題の説明を入力
   - 自動診断の実行
   - 推奨される解決策
   ```

2. **管理者向け診断**
   - メッセージ追跡
   - ユーザー接続テスト
   - サービス正常性確認

### ログ収集と分析
1. **クライアントログ**
   - Teams ログ
   - OneDrive 同期ログ
   - Outlook 接続ログ

2. **サーバー側ログ**
   - Exchange メッセージ追跡
   - SharePoint ULSログ
   - Azure AD サインインログ

## 7.10 ベストプラクティス

### 監視体制の確立
1. **役割分担**
   - L1: 日次監視（ヘルプデスク）
   - L2: 週次分析（IT管理者）
   - L3: 戦略的分析（IT責任者）

2. **エスカレーション手順**
   - アラート重要度の定義
   - 対応時間の設定
   - 連絡体制の整備

### 継続的改善
1. **定期的な見直し**
   - 月次レビュー会議
   - KPIの見直し
   - 監視項目の追加/削除

2. **自動化の推進**
   - 繰り返し作業の特定
   - スクリプト化
   - ワークフローの最適化

## まとめ

効果的な監視と分析は、Microsoft 365環境の安定運用に不可欠です。各種ツールを組み合わせて包括的な監視体制を構築し、問題の早期発見と迅速な対応を実現しましょう。次章では、実際に問題が発生した際のトラブルシューティング手法について詳しく説明します。