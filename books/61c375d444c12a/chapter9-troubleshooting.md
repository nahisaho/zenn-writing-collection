---
title: "第10章: トラブルシューティング"
---

## 10.1 トラブルシューティングの基本アプローチ

### 問題解決のフレームワーク
1. **問題の特定**
   - 症状の詳細な記録
   - 影響範囲の確認
   - 発生時期の特定
   - 再現性の確認

2. **情報収集**
   - エラーメッセージ
   - イベントログ
   - 環境情報
   - 最近の変更履歴

3. **原因分析**
   - 仮説の立案
   - 検証作業
   - 根本原因の特定

4. **解決と文書化**
   - 対処法の実施
   - 結果の確認
   - 手順の文書化
   - 再発防止策

## 8.2 サインインの問題

### よくあるサインインエラー

#### 1. パスワードが正しくない
```
エラー: AADSTS50126
原因と対処:
- パスワードの再入力（大文字小文字、NumLock確認）
- パスワードリセット
- アカウントロックアウトの確認
```

#### 2. 多要素認証（MFA）の問題
```
症状: MFAプロンプトが表示されない/通らない
対処法:
1. 代替認証方法の使用
2. MFA設定のリセット（管理者）
   Set-MsolUser -UserPrincipalName user@school.edu -StrongAuthenticationMethods @()
3. 認証アプリの再登録
```

#### 3. 条件付きアクセスによるブロック
```
エラー: AADSTS53003
確認項目:
- アクセス元IPアドレス
- デバイスのコンプライアンス状態
- 該当する条件付きアクセスポリシー
```

### 診断ツールの活用
```powershell
# Azure AD サインインログの確認
Get-AzureADAuditSignInLogs -Filter "userPrincipalName eq 'user@school.edu'" | 
Select-Object CreatedDateTime, Status, ConditionalAccessStatus
```

## 8.3 Microsoft Teams の問題

### 音声・ビデオの問題

#### 1. 音声が聞こえない/届かない
```
チェックリスト:
□ デバイスの選択確認（設定 > デバイス）
□ ミュート状態の確認
□ Windowsの音声設定
□ ドライバーの更新
□ ファイアウォール/プロキシ設定
```

#### 2. ビデオが表示されない
```
対処法:
1. カメラの権限確認
   - Windows設定 > プライバシー > カメラ
2. 他のアプリケーションでのカメラ使用確認
3. Teamsの再インストール
4. GPU アクセラレーションの無効化
```

### Teams クライアントの問題

#### キャッシュのクリア
```batch
:: Windows
%appdata%\Microsoft\Teams\Cache
%appdata%\Microsoft\Teams\blob_storage
%appdata%\Microsoft\Teams\databases
%appdata%\Microsoft\Teams\GPUCache
%appdata%\Microsoft\Teams\IndexedDB
%appdata%\Microsoft\Teams\Local Storage
%appdata%\Microsoft\Teams\tmp
```

#### ネットワーク要件の確認
```
必要なURL/IPアドレス:
- *.teams.microsoft.com
- *.skype.com
- *.sharepoint.com
ポート:
- TCP: 80, 443
- UDP: 3478-3481
```

## 8.4 メールの問題

### メール送受信のトラブル

#### 1. メールが届かない
```
確認手順:
1. メッセージ追跡の実行
   管理センター > Exchange > メールフロー > メッセージ追跡
2. 迷惑メールフォルダーの確認
3. ブロックリスト/許可リストの確認
4. メールフロールールの確認
```

#### 2. 送信制限エラー
```
エラー: 5.1.8 Access denied, bad outbound sender
原因:
- 送信制限（30通/分、10,000通/日）
- スパム判定によるブロック
対処:
- 送信ペースの調整
- 大量送信用の配布グループ使用
```

### Outlookクライアントの問題

#### プロファイルの再作成
```
1. コントロールパネル > Mail
2. プロファイルの表示
3. 削除 > 新規作成
4. 自動構成での再設定
```

#### 接続性テスト
```powershell
# Exchange Online接続テスト
Test-NetConnection outlook.office365.com -Port 443
```

## 8.5 SharePoint/OneDrive の問題

### 同期エラーの解決

#### 1. 同期が停止/エラー
```
一般的な原因:
- ファイル名に使用できない文字
- パスが長すぎる（260文字超）
- ファイルサイズ制限（100GB）
- 同時編集の競合

解決手順:
1. 同期の一時停止と再開
2. 問題ファイルの特定（同期クライアントのエラー詳細）
3. ファイル名/パスの修正
4. 同期のリセット
```

#### 2. アクセス権限エラー
```
確認項目:
- サイト/ライブラリレベルの権限
- 権限の継承状態
- 共有リンクの有効期限
- 条件付きアクセスポリシー
```

### パフォーマンスの問題

#### サイトの読み込みが遅い
```
対処法:
1. ページ診断ツールの実行
2. 大きな画像/ファイルの最適化
3. リスト/ライブラリのビュー制限（5,000件）
4. インデックス列の設定
```

## 8.6 ライセンスとアクティベーションの問題

### Office アプリケーションのライセンスエラー

#### ライセンス認証の失敗
```
対処手順:
1. ライセンス割り当ての確認
2. Office のサインアウト/サインイン
3. ライセンス情報のリセット
   
コマンドプロンプト（管理者）:
cd "C:\Program Files\Microsoft Office\Office16"
cscript ospp.vbs /dstatus
cscript ospp.vbs /unpkey:XXXXX (下5桁)
cscript ospp.vbs /remhst
```

### ライセンスの競合
```
症状: "組織のアカウントは既に..."
解決:
1. 資格情報マネージャーのクリア
2. レジストリのクリーンアップ
   HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Common\Identity
```

## 8.7 モバイルデバイスの問題

### MDM登録の失敗
```
エラーコード別対処:
- 0x80180014: 既に登録済み → 既存登録の削除
- 0x801c0003: ネットワークエラー → プロキシ/VPN確認
- 0x80072f89: 証明書エラー → 日時設定確認
```

### アプリ保護ポリシーの問題
```
症状: アプリでデータが開けない
確認:
1. ポリシーの適用状態
2. アプリのバージョン
3. 認証状態
4. PINの再設定
```

## 8.8 パフォーマンス問題の診断

### ネットワーク診断
```powershell
# Microsoft 365 接続テスト
Invoke-WebRequest -Uri https://connectivity.office.com/api/report/microsoft365 | 
ConvertFrom-Json

# 遅延測定
Test-NetConnection outlook.office365.com -TraceRoute
```

### クライアント側の最適化
1. **ブラウザー**
   - キャッシュのクリア
   - 拡張機能の無効化
   - 別ブラウザーでのテスト

2. **システム**
   - Windows Update
   - ドライバー更新
   - ウイルス対策の除外設定

## 8.9 データ復旧

### 削除されたアイテムの復元

#### 1. メールの復元
```
Outlook Web App:
削除済みアイテム > 削除済みアイテムを復元
（14日以内）

PowerShell（30日以内）:
Get-RecoverableItems -Identity user@school.edu -FilterItemType IPM.Note
```

#### 2. SharePoint/OneDriveファイルの復元
```
ごみ箱（93日間保持）:
- 第1段階: サイトのごみ箱
- 第2段階: サイトコレクションのごみ箱

バージョン履歴からの復元
ファイルの復元（過去30日間の任意の時点）
```

## 8.10 エスカレーション手順

### サポートへの問い合わせ準備
1. **必要な情報**
   - テナント名/ID
   - 影響を受けるユーザー
   - 問題の詳細な説明
   - エラーメッセージ/スクリーンショット
   - 実施済みのトラブルシューティング

2. **サポートリクエストの作成**
   ```
   管理センター > サポート > 新しいサービスリクエスト
   - 問題の要約
   - 詳細説明
   - 添付ファイル
   - 緊急度の選択
   ```

### 緊急時の対応
- **Severity A（緊急）**: 全面的なサービス停止
- **Severity B（高）**: 主要機能の停止
- **Severity C（通常）**: 部分的な問題

## まとめ

トラブルシューティングは体系的なアプローチと適切なツールの使用が鍵となります。よくある問題とその解決方法を理解し、文書化することで、迅速な問題解決が可能になります。次章では、これまでの内容を踏まえた、教育現場でのベストプラクティスについて説明します。